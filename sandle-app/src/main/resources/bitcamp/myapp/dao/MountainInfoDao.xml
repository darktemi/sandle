<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="bitcamp.myapp.dao.MountaininfoDao">

  <resultMap type="mountaininfo" id="mountaininfoMap">
    <id column="mountaininfo_id" property="no"/>
    <result column="name" property="name"/>
    <result column="tel" property="tel"/>
    <result column="email" property="email"/>
    <result column="profile_photo" property="profilePhoto"/>
    <result column="post_no" property="postNo"/>
    <result column="basic_address" property="basicAddress"/>
    <result column="detail_address" property="detailAddress"/>
    <result column="status_message" property="statusMessage"/>
    <result column="authority" property="authority"/>
    <result column="birth" property="birth"/>
    <result column="created_date" property="createdDate"/>
  </resultMap>

  <select id="findAll" resultMap="mountaininfoMap">
    select 
      m.mountain_info_id, 
      m.region_id,
      m.mountain_name,
      m.height,
      m.photo,
      m.address,
      m.sunrise,
      m.sunset
    from 
      hms_mountain_info m
      inner join hms_region r on m.region_id = r.region_id
    <if test="keyword != '' and keyword != null">
    where
      m.mountain_name like(concat('%', #{keyword}, '%'))
      or m.height like(concat('%', #{keyword}, '%'))
      or m.address like(concat('%', #{keyword}, '%'))
      or m.region like(concat('%', #{keyword}, '%'))
    </if>
    order by 
      m.mountain_info_id desc
  </select>

  <select id="findByNo" parameterType="int" resultMap="mountaininfoMap">
    select 
      m.mountain_info_id, 
      m.region_id,
      m.mountain_name,
      m.height,
      m.photo,
      m.address,
      m.sunrise,
      m.sunset
    from 
      hms_mountain_info m
      inner join hms_region r on m.region_id = r.region_id
    where 
      m.mountain_info_id=#{no}
  </select>
</mapper>





